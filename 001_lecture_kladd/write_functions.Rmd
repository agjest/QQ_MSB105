---
title: "Writing functions"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook showing how to write some simple functions.

### First attempt

Simple function with *for next loop*.

```{r}
start_stupid_fun <- function(x1 = 0, n = 10) {
# initialise x
x <- vector(mode="numeric", length = n)
x[1] = x1

for (i in seq_along(x[-1])) {
  x[i+1] = x[i] + 1
}

print(x)
}
```

```{r}
start_stupid_fun(x1=5, n=15)
```

### Extensions

```{r}
stupid_fun <- function(x1 = 0, n = 10, d = 1, width_fraction = 0.4, print_to_console = TRUE) {
  stopifnot(n>0)
  dig <-  nchar(n*d)
x <- vector(mode="numeric", length = n)
x[1] = x1

for (i in seq_along(x[-1])) {
  x[i+1] = x[i] + d
}

if(print_to_console) {
print(stringr::str_pad(x, width = dig, side = "left", pad = " "),
      width = width_fraction*getOption("width"))
  } else {
    tibble(x)
  }
}
```

```{r}
stupid_fun(x1 = -13, n = 100, d = 5, print_to_console=FALSE) %>% 
  View()
```

## Head_and_tail

We have the functions `head()` and `tail()` to inspect respectively the start and end of an R object.
Sometime we'll want to do bought with one command.

### First attempt

```{r}
head_and_tail <- function(x) {
  c(head(x), tail(x))
}
```

```{r}
head_and_tail(mtcars[,1:6])
```

### Second attempt

```{r}
head_and_tail <- function(x, n=3L) {
  as_tibble(rbind(head(x, n = n),  rep('#',length(names(x))), tail(x, n = n)))
}
```

```{r}
head_and_tail(mtcars[,1:6], n=7)
```

```{r}
h_a_t <- head_and_tail(mtcars[,1:6], n=7)
View(h_a_t)
```

```{r}
h_a_t
```
